```{r}
library(pacman)
p_load(
  here,
  rgdal,
  sf,
  terra,
  ggplot2,
  tmap,
  dplyr,
  gridExtra,
  cowplot,
  ggforce,
  concaveman
)
df <- read.csv(here("data", "listings.csv"))
```

```{r}
shape <- st_read(here("data", "SF Find Neighborhoods"))
tmap_mode("plot")
```

```{r}
shape_plot <- shape %>% ggplot()+ geom_sf()
scatt<- shape_plot + 
  geom_point(data=df, aes(y=latitude, x=longitude), alpha=0.5, color="red", size=0.1)
```

```{r}
groups <- 30
heat<- shape_plot + 
  stat_bin2d(data= df, aes(x=longitude, y=latitude), alpha=0.7, bins = groups) +
  scale_fill_viridis_c(option="C", trans="log") +
  theme(legend.position = "none")
grid.arrange(scatt, heat, ncol=2)
```


```{r}
coloredScatt <- shape_plot +
  geom_point(data=df, aes(y=latitude, x=longitude, color=neighbourhood), alpha=0.5, size=0.1)+
  theme(legend.position = "none")
coloredPolygn <- shape_plot +
  geom_mark_hull(data=df, aes(y=latitude, x=longitude, fill=neighbourhood), expand = 0, radius=0,alpha=0.7, size=0.1, level=0.2) + 
  theme(legend.position = "none")
grid.arrange(coloredScatt, coloredPolygn, ncol=2)
```

```{r}
colors
```







































